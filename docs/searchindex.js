Search.setIndex({"docnames": ["howtouse", "index", "overview", "torch_HLattice", "torch_PMLinear", "torch_PiecewiseLinear", "tutorial_auxiliary_network", "tutorial_torch_HLattice", "tutorial_torch_PiecewiseLinear"], "filenames": ["howtouse.rst", "index.rst", "overview.rst", "torch_HLattice.rst", "torch_PMLinear.rst", "torch_PiecewiseLinear.rst", "tutorial_auxiliary_network.rst", "tutorial_torch_HLattice.rst", "tutorial_torch_PiecewiseLinear.rst"], "titles": ["How to Use", "Documentation of pmlayer", "What is partially monotone layer?", "pmlayer.torch.layers.HLattice", "pmlayer.torch.layers.PMLinear", "pmlayer.torch.layers.PiecewiseLinear", "How to use custom auxiliary neural network in pmlayer.torch.layers.HLattice", "How to use pmlayer.torch.layers.HLattice", "How to use pmlayer.torch.layers.PiecewiseLinear"], "terms": {"pip": [0, 1], "pmlayer": [0, 2], "code": [0, 3, 4, 5, 6, 7, 8], "ar": [0, 5, 6], "avail": [0, 6, 7, 8], "http": 0, "github": [0, 6, 7, 8], "com": 0, "ibm": 0, "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8], "paper": [0, 1], "explain": 0, "technic": 0, "detail": 0, "h": [0, 1], "yanagisawa": [0, 1], "k": [0, 1, 7], "miyaguchi": [0, 1], "t": [0, 1], "katsuki": [0, 1], "hierarch": [0, 1, 3], "lattic": [0, 1, 3, 6, 7], "layer": [0, 1], "partial": [0, 1, 3, 4], "monoton": [0, 1, 3, 4, 5, 6, 7, 8], "regress": [0, 1], "neurip": [0, 1], "2022": [0, 1], "provid": [1, 2], "set": [3, 4, 6, 8], "pytorch": [1, 3, 4, 5, 7], "what": 1, "i": [1, 3, 4, 5, 6, 7, 8], "how": [], "us": [1, 2, 3, 5], "instal": [], "relev": [], "torch": 1, "hlattic": 1, "piecewiselinear": 1, "pmlinear": 1, "suppos": [2, 6], "we": [2, 6, 7, 8], "want": 2, "train": [2, 7, 8], "function": [2, 5, 6, 7, 8], "f": [2, 6, 7, 8], "x": [2, 3, 4, 5, 6, 7, 8], "y": [2, 3, 4, 5, 7, 8], "2": [2, 3, 4, 5, 6, 7, 8], "neural": [1, 2, 3, 8], "network": [1, 2, 3, 8], "increas": [2, 3, 4, 5, 7, 8], "can": [2, 3, 6, 7, 8], "learn": [2, 4, 7, 8], "standard": [2, 7], "guarante": 2, "The": [1, 3, 4, 5, 6, 7, 8], "design": 8, "handl": [2, 5, 6], "constraint": [1, 2, 3, 4, 5, 6, 7, 8], "therefor": [2, 6], "output": [3, 4, 5, 6, 7, 8], "respect": [2, 4, 5, 7], "kei": [], "In": [6, 7, 8], "time": 7, "grid": 7, "creat": [], "where": 7, "geq": 7, "hyperparamet": 7, "specifi": [4, 5, 7, 8], "granular": 7, "each": [3, 5, 6, 7, 8], "point": [], "valu": [3, 5, 7], "thei": [], "satisfi": 7, "class": [3, 4, 5, 6], "num_input_dim": [3, 4, 6], "lattice_s": [3, 6, 7], "indices_increas": [3, 4, 5, 6, 8], "neural_network": [3, 6], "none": 3, "structur": 7, "arg": [3, 4, 5], "type": [3, 4, 5], "descript": [3, 4, 5], "int": [3, 4, 5], "number": [4, 5, 6], "input": [3, 4, 5, 6, 7, 8], "featur": [3, 4, 5, 6, 7, 8], "list": [3, 4, 5], "size": [3, 4, 5, 6, 8], "default": [3, 4, 5, 6], "indic": [3, 4, 5], "o": [3, 4, 5, 8], "n": [3, 4, 5], "1": [3, 4, 5, 7, 8], "follow": [3, 4, 5, 6, 7, 8], "128": [3, 4, 5, 6], "l": [3, 4, 5], "10": [3, 4, 5, 7, 8], "3": [3, 4, 5, 7, 8], "randn": [3, 4, 5], "print": [3, 4, 5], "linear": [4, 5, 6, 8], "num_output_dim": 4, "indices_decreas": [4, 5], "use_bia": 4, "true": 4, "appli": 4, "transform": [3, 4, 5, 8], "incom": 4, "data": [4, 7, 8], "ax": [4, 7], "b": [4, 5], "decreas": [4, 5], "bool": 4, "If": [4, 6], "fals": 4, "an": [4, 6, 8], "addit": 4, "bia": 4, "5": [4, 5], "pies": [], "wise": [5, 8], "input_keypoint": 5, "num_dim": 5, "output_min": 5, "0": [3, 5, 6, 7, 8], "output_max": 5, "indices_transform": 5, "piecewis": 5, "tensor": [6, 7, 8], "boundari": [5, 8], "float": 5, "minimum": 5, "maximum": 5, "piec": [5, 8], "without": [5, 8], "linspac": [5, 7, 8], "step": [5, 7, 8], "import": [6, 7, 8], "model": [1, 2, 6, 7, 8], "4": [3, 6, 7, 8], "exampl": [7, 8], "singl": [7, 8], "construct": [2, 7, 8], "predict": [], "first": [7, 8], "argument": 7, "show": [7, 8], "receiv": 7, "two": 7, "dimension": 7, "second": [7, 8], "both": 7, "third": 7, "equal": 6, "prepar": [7, 8], "np": [7, 8], "x1": 7, "x2": 7, "meshgrid": 7, "concaten": 7, "reshap": [7, 8], "data_x": [7, 8], "from_numpi": [7, 8], "astyp": [7, 8], "float32": [7, 8], "clone": [7, 8], "data_i": [7, 8], "loss_funct": [7, 8], "nn": [6, 7, 8], "mseloss": [7, 8], "optim": [7, 8], "sgd": 7, "paramet": [6, 7, 8], "lr": [7, 8], "001": 7, "epoch": [7, 8], "rang": [7, 8], "5000": 7, "pred_i": [7, 8], "loss": [7, 8], "zero_grad": [7, 8], "backward": [7, 8], "By": [3, 7], "verifi": 8, "succeed": [], "plot": [7, 8], "pred_y_np": [7, 8], "cpu": [7, 8], "detach": [7, 8], "numpi": [7, 8], "copi": [7, 8], "shape": 7, "plt": [7, 8], "figur": [7, 8], "figsiz": [7, 8], "subplot": [7, 8], "im": 7, "contourf": 7, "level": 7, "6": 7, "8": 7, "subplots_adjust": 7, "left": 7, "bottom": 7, "right": 7, "7": [7, 8], "top": 7, "9": 7, "cax": 7, "05": 7, "colorbar": 7, "repres": 4, "pwl": 8, "endpoint": 8, "them": [], "batch_siz": [], "n_input": [], "rand": [], "must": [3, 6], "between": 3, "usual": [3, 4, 5], "batch": [3, 4, 5], "long": [3, 6, 7], "dtype": [3, 6, 7], "piesewis": 5, "knot": 5, "tutori": [6, 7, 8], "consist": [7, 8], "see": 7, "demonstr": [6, 7, 8], "you": [6, 7, 8], "method": 7, "shown": 7, "appropri": 7, "dimens": 8, "tile": 8, "adam": 8, "01": 8, "10000": 8, "fig": 8, "ax1": 8, "ax2": 8, "set_titl": 8, "color": 8, "grai": 8, "linestyl": 8, "dot": 8, "marker": 8, "unconstrain": 8, "which": 2, "mean": 8, "do": 8, "monotom": 1, "librari": 1, "It": 1, "sevral": [], "add": 1, "current": 1, "implement": 1, "pleas": 1, "consid": 1, "cite": 1, "openreview": [], "net": [], "forum": [], "id": [], "zauizpz478l": [], "_": [], "cannot": 2, "pmalyer": 2, "libtrai": 2, "sever": [1, 2], "length": [3, 6], "vector": [3, 8], "latic": 3, "entri": 3, "correspond": [3, 5], "least": 3, "sub": 3, "intern": [3, 7], "replac": [3, 6], "sourc": [6, 7, 8], "blob": [], "main": [], "sampl": [], "sample_1d_pwl": [], "py": [], "from": [7, 8], "constructor": 8, "also": 8, "result": 8, "blue": 8, "solid": 8, "line": 8, "ground": 8, "truth": 8, "sinc": 8, "under": 8, "contrast": 8, "ani": 8, "note": [5, 7], "individu": 5, "vertex": 7, "coordin": 7, "while": 7, "custom": 1, "auxiliari": 1, "To": 6, "multi": 6, "perceptron": 6, "mlp": 6, "three": 6, "hidden": 6, "ha": 6, "neuron": 6, "have": 6, "modul": 6, "def": 6, "__init__": 6, "self": 6, "input_len": 6, "output_len": 6, "num_neuron": 6, "super": 6, "fc1": 6, "fc2": 6, "init": [], "kaiming_normal_": [], "weight": [], "forward": 6, "relu": 6, "sigmoid": 6, "return": 6, "non": 6, "e": 6, "product": 6, "len": 6, "prod": 6, "item": 6, "ann": 6, "32": 6, "all": 6, "zero": 6, "abov": 6, "doe": 6, "ignor": 6}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"how": [0, 1, 6, 7, 8], "us": [0, 6, 7, 8], "instal": [0, 1], "open": 0, "sourc": 0, "citat": [0, 1], "document": 1, "pmlayer": [1, 3, 4, 5, 6, 7, 8], "overview": 1, "tutori": 1, "api": 1, "refer": 1, "what": 2, "i": 2, "partial": 2, "monoton": 2, "layer": [2, 3, 4, 5, 6, 7, 8], "torch": [3, 4, 5, 6, 7, 8], "hlattic": [3, 6, 7], "paramet": [3, 4, 5], "shape": [3, 4, 5], "exampl": [3, 4, 5], "pmlinear": 4, "piecewiselinear": [5, 8], "tensor": [3, 4, 5], "custom": 6, "auxiliari": 6, "neural": 6, "network": 6}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"How to Use": [[0, "how-to-use"]], "Install": [[0, "install"]], "Open Source": [[0, "open-source"]], "Citation": [[0, "citation"], [1, "citation"]], "What is partially monotone layer?": [[2, "what-is-partially-monotone-layer"]], "Parameters": [[3, "parameters"], [4, "parameters"], [5, "parameters"]], "Tensor Shape": [[3, "tensor-shape"], [4, "tensor-shape"], [5, "tensor-shape"]], "Example": [[3, "example"], [4, "example"], [5, "example"]], "pmlayer.torch.layers.HLattice": [[3, "pmlayer-torch-layers-hlattice"]], "pmlayer.torch.layers.PMLinear": [[4, "pmlayer-torch-layers-pmlinear"]], "How to use pmlayer.torch.layers.PiecewiseLinear": [[8, "how-to-use-pmlayer-torch-layers-piecewiselinear"]], "pmlayer.torch.layers.PiecewiseLinear": [[5, "pmlayer-torch-layers-piecewiselinear"]], "How to use pmlayer.torch.layers.HLattice": [[7, "how-to-use-pmlayer-torch-layers-hlattice"]], "Documentation of pmlayer": [[1, "documentation-of-pmlayer"]], "Overview:": [[1, null]], "How to install": [[1, "how-to-install"]], "Tutorial:": [[1, null]], "API Reference:": [[1, null]], "How to use custom auxiliary neural network in pmlayer.torch.layers.HLattice": [[6, "how-to-use-custom-auxiliary-neural-network-in-pmlayer-torch-layers-hlattice"]]}, "indexentries": {}})